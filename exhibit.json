{
    "PixelsPerMicron": 2.50780002295,
    "Images": [
        {
            "Name": "i0",
            "Description": "",
            "Path": "images/hu-normal-liver-001",
            "Width": 49152,
            "Height": 81920,
            "MaxLevel": 7
        }
    ],
    "Header": "![image](img/SOA_logo.png)",
    "Rotation": 0,
    "Layout": {
        "Grid": [
            [
                "i0"
            ]
        ]
    },
    "Appendix": "For more information on NanoString GeoMx technology, visit [**our website**](https://www.nanostring.com/products/geomx-digital-spatial-profiler/geomx-dsp-overview/).\n\nDetails of the performance of GeoMx Whole Transcriptome Atlas (WTA) have been [**published**](https://doi.org/10.1101/2021.09.29.462442).\n\nThe liver data were generated by [**Fynn Biotechnologies**](https://www.fynnbio.com).\n\nMinerva is an open-source software package that was developed by Laboratory of Systems Pharmacology at Harvard University and is available [**here**](https://github.com/labsyspharm/minerva-story/wiki). We would like to thank Jeremy Muhlich and John Thomas Hoffer for assistance in enabling Minerva features to support the Spatial Organ Atlas.\n\n[![Foo](img/Minerva_FinalLogo_RGB.svg)](https://minerva.im/)\n\nSources:\n\n* Rashid R, Chen YA, Hoffer J, et al. Narrative online guides for the interpretation of digital-pathology images and tissue-atlas data. Nat Biomed Eng. Published online November 8, 2021:1-12. [doi:10.1038/s41551-021-00789-8](https://doi.org/10.1038/s41551-021-00789-8)\n\n* Hoffer J, Rashid R, Muhlich JL, et al. Minerva: a light-weight, narrative image browser for multiplexed tissue images. J Open Source Softw. 2020;5(54):2579. [doi:10.21105/joss.02579](https://doi.org/10.21105/joss.02579)\n\n* MacParland SA, Liu JC, Ma XZ, et al. Single cell RNA sequencing of human liver reveals distinct intrahepatic macrophage populations. Nat Commun. 2018;9(1):4383. [doi:10.1038/s41467-018-06318-7](https://doi.org/10.1038/s41467-018-06318-7)\n\nFOR RESEARCH USE ONLY. Not for use in diagnostic procedures.",
    "Stories": [
        {
            "Name": "A liver story created by Nanostring and Fynnbio",
            "Description": "Welcome to the [**Spatial Organ Atlas (SOA)**](https://www.nanostring.com/spatial-organ-atlas) Human Liver Demonstration.\n\nThe SOA is a database for whole transcriptome spatial profiles of functional components of tissues from human and mouse generated with the GeoMx<sup>®</sup> Digital Spatial Profiler. All the data in the SOA are downloadable, including this [**human liver sample (#001)**](https://nanostring.com/products/geomx-digital-spatial-profiler/spatial-organ-atlas/human-liver/). The liver data were generated by [**Fynn Biotechnologies**](https://www.fynnbio.com). \n\nUsing [**Minerva**](https://github.com/labsyspharm/minerva-story/wiki), we will show you how the imaging and molecular data combine to give you a comprehensive profile of the tissue architecture and biology.\n\nClick around to explore on your own. \n\nHints:\n* The Minerva Story is best viewed using Google Chrome.\n* Zoom and pan the image via the mouse/trackpad. Dependent on browser and operating system, keyboard shortcuts are available: + zoom in, - zoom out, pan via arrow keys.\n* Open and close the left- and right-hand menus by clicking on < or >.\n* See results in the left-hand menu and click on the selectable regions to zoom to the featured area of the tissue.\n* Turn channels on and off with the right-hand menu.",
            "Waypoints": [
                {
                    "Name": "Gross Liver Anatomy",
                    "Description": "The liver is the largest internal organ in the human body. It is involved in three major vital functions: storage, detoxification and synthesis. The liver helps improve digestion, removes toxins and other impurities from the body, regulates blood clotting, removes bacteria from the blood and maintains the balance of hormones. The functional unit of the liver is the lobule. Each lobule is hexagonal and a portal triad - consisting of a portal vein, a hepatic artery, and a bile duct - sits at each corner of the hexagon. The composition of the lobule is primarily hepatocytes, which have physiologically distinct apical and basolateral membranes and carry out the primary function of the liver. The remaining 30-40% of liver cells are composed of Kupffer cells, hepatic stellate cells, and hepatic endothelial sinusoidal cells. Kupffer cells are a liver-specific specialized macrophage cell type that forms the innate immune system of the liver, owing to the organ's special function in detoxification and close association with gut contents. Stellate and endothelial sinusoidal cells serve a role in vitamin/lipid storage and as a barrier, respectively. \n\nThis liver sample shown to the right represents a 5 µm FFPE (Formalin Fixed Paraffin Embedded) tissue section from a 72-year-old man. The sample was visualized with CK8/18 (hepatocytes), CD68 (Kupffer cells/macrophages), α-SMA (sinusoid and stellate cells) and SYTO 83 (nuclei). In parallel, the sample was molecularly profiled with the [GeoMx Human Whole Transcriptome Atlas (WTA) assay](https://www.nanostring.com/products/geomx-digital-spatial-profiler/geomx-rna-assays/geomx-whole-transcriptome-atlas/).\n\nFigure modified from [MacParland et al., 2018](https://doi.org/10.1038/s41467-018-06318-7)",
                    "Arrows": [],
                    "Overlays": [],
                    "Group": "All Markers",
                    "Masks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3",
                        "Central Vein",
                        "Bile Duct",
                        "Artery",
                        "Portal Vein",
                        "CV Macrophage",
                        "CV Sinusoid",
                        "Liver Macrophage",
                        "Liver Sinusoid",
                        "PV Macrophage",
                        "PV Sinusoid"
                    ],
                    "ActiveMasks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3",
                        "Central Vein",
                        "Bile Duct",
                        "Artery",
                        "Portal Vein",
                        "CV Macrophage",
                        "CV Sinusoid",
                        "Liver Macrophage",
                        "Liver Sinusoid",
                        "PV Macrophage",
                        "PV Sinusoid"
                    ],
                    "Zoom": 1,
                    "Pan": [
                        0.5,
                        0.5
                    ]
                },
                {
                    "Name": "Detailed Liver Anatomy",
                    "Description": "With GeoMx DSP, Regions of Interest (ROIs) are selected by the user and then molecularly profiled. These ROIs can be either profiled whole (i.e., geometric profiling) or subdivided based on the visible morphology markers into compartments and profiled separately (i.e., segmented and rare cell profiling). In the figure below, the key features of the liver lobule are highlighted and corresponding ROIs are mapped on the tissue image to the right. You can click on the outlined names of the liver structure in the figure to see example ROIs on the tissue image, and you can toggle the ROIs by selecting from the data layers below.<sup>1</sup>\n* Liver lobular zones (Zone 1, Zone 2, and Zone 3): Geometric\n* Portal triad (Bile Duct, Artery and Portal Vein): Geometric\n* Central Vein: Geometric\n* Kupffer cells (surrounding Portal Vein, surrounding Central Vein and the lobular area): CD68+ segmented\n* Sinusoids and Stellate cells (surrounding Portal Vein, surrounding Central Vein and the lobular area): α-SMA+ segmented\n\nBased on function and perfusion, lobules are divided into three zones. \n* Zone I is defined to be the periportal region of the lobule and is the best perfused and first to regenerate due to its proximity to oxygenated blood and nutrients. Due to its high perfusion, zone I hepatocytes play a large role in oxidative metabolism including beta-oxidation, gluconeogenesis, bile formation, cholesterol formation, and amino acid catabolism. \n* Zone II is defined as the pericentral region and sits between zones I and III. \n* Zone III has the lowest perfusion due to its distance from the portal triad. It plays the largest role in detoxification, biotransformation of drugs, ketogenesis, glycolysis, lipogenesis, glycogen synthesis, and glutamine formation.\n\n<sup>1</sup>[Modified from MacParland et al., 2018](https://doi.org/10.1038/s41467-018-06318-7)",
                    "Arrows": [],
                    "Overlays": [],
                    "Group": "CD68/SMA/DNA",
                    "Masks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3",
                        "Central Vein",
                        "Bile Duct",
                        "Artery",
                        "Portal Vein",
                        "CV Macrophage",
                        "CV Sinusoid",
                        "Liver Macrophage",
                        "Liver Sinusoid",
                        "PV Macrophage",
                        "PV Sinusoid"
                    ],
                    "ActiveMasks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3",
                        "Central Vein",
                        "Bile Duct",
                        "Artery",
                        "Portal Vein",
                        "CV Macrophage",
                        "CV Sinusoid",
                        "Liver Macrophage",
                        "Liver Sinusoid",
                        "PV Macrophage",
                        "PV Sinusoid"
                    ],
                    "Zoom": 1,
                    "Pan": [
                        0.5,
                        0.5
                    ]
                },
                {
                    "Name": "Linking Molecular and Imaging Data",
                    "Description": "One of the key aspects of spatial biology is the ability to link molecular data to spatial information. In this plot, the number of genes detected per ROI by each liver structure is shown. Select a data point within the plot to see its corresponding ROI in the SOA image.\n\nAs expected, the geometric ROIs in lobular zones, central veins, portal veins and bile ducts showed considerably more detected genes than segmented ROIs of Kupffer cells and sinusoid cells, which are single cell types.",
                    "Footer": "Hints:\n* Select a single data point in the graph to spot the corresponding ROI in the SOA image.",
                    "Arrows": [],
                    "Overlays": [],
                    "Group": "CD68/SMA/DNA",
                    "Masks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3",
                        "Central Vein",
                        "Bile Duct",
                        "Artery",
                        "Portal Vein",
                        "CV Macrophage",
                        "CV Sinusoid",
                        "Liver Macrophage",
                        "Liver Sinusoid",
                        "PV Macrophage",
                        "PV Sinusoid"
                    ],
                    "ActiveMasks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3",
                        "Central Vein",
                        "Bile Duct",
                        "Artery",
                        "Portal Vein",
                        "CV Macrophage",
                        "CV Sinusoid",
                        "Liver Macrophage",
                        "Liver Sinusoid",
                        "PV Macrophage",
                        "PV Sinusoid"
                    ],
                    "Zoom": 1,
                    "Pan": [
                        0.5,
                        0.5
                    ],
                    "MaskAndPan": {
                        "config": {
                            "view": {
                                "continuousWidth": 400,
                                "continuousHeight": 300
                            },
                            "background": null
                        },
                        "width": "container",
                        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                        "data": {
                            "url": "data/GenesDetected.csv"
                        },
                        "mark": {
                            "type": "point",
                            "filled": true,
                            "stroke": "white",
                            "strokeWidth": 0.5,
                            "size": 80
                        },
                        "encoding": {
                            "x": {
                                "field": "x_axis",
                                "type": "quantitative",
                                "axis": {
                                    "labelExpr": "datum.label == 1 ? 'Zone 1' : datum.label == 2 ? 'Zone 2' : datum.label == 3 ? 'Zone 3' : datum.label == 4 ? 'Central Vein' : datum.label == 5 ? 'Bile Duct' : datum.label == 6 ? 'Artery' : datum.label == 7 ? 'Portal Vein' : datum.label == 8 ? 'CV Macrophage' : datum.label == 9 ? 'CV Sinusoid' : datum.label == 10 ? 'Liver Macrophage' : datum.label == 11 ? 'Liver Sinusoid' : datum.label == 12 ? 'PV Macrophage' : datum.label == 13 ? 'PV Sinusoid' : null",
                                    "labelAngle": -90,
                                    "tickCount": 13,
                                    "grid": false
                                },
                                "scale": {
                                    "domain": [
                                        0,
                                        14
                                    ]
                                },
                                "title": null
                            },
                            "y": {
                                "field": "GenesDetected",
                                "type": "quantitative",
                                "title": "Genes Detected, # > LOQ"
                            },
                            "color": {
                                "field": "type",
                                "type": "nominal",
                                "legend": {
                                    "orient": "bottom",
                                    "direction": "vertical"
                                },
                                "title": "ROI Category",
                                "scale": {
                                    "domain": [
                                        "Zone 1",
                                        "Zone 2",
                                        "Zone 3",
                                        "Central Vein",
                                        "Bile Duct",
                                        "Artery",
                                        "Portal Vein",
                                        "CV Macrophage",
                                        "CV Sinusoid",
                                        "Liver Macrophage",
                                        "Liver Sinusoid",
                                        "PV Macrophage",
                                        "PV Sinusoid"
                                    ],
                                    "range": [
                                        "#fec4e4",
                                        "#f093c7",
                                        "#be719c",
                                        "#37a7e5",
                                        "#d55e00",
                                        "#f0e442",
                                        "#009e73",
                                        "#ccf2f7",
                                        "#fdae70",
                                        "#b9f9e8",
                                        "#beb532",
                                        "#fff9ad",
                                        "#cbcbcb"
                                    ]
                                }
                            },
                            "tooltip": [
                                {
                                    "field": "GenesDetected",
                                    "type": "quantitative"
                                },
                                {
                                    "field": "type",
                                    "type": "nominal",
                                    "title": "ROI category"
                                }
                            ]
                        }
                    }
                },
                {
                    "Name": "Differential Gene Expression in Liver Zones",
                    "Description": "In this analysis, we compare gene expression between the different zones of the hepatic lobules. We can see a number of genes that are differentially expressed, including several *CYP* family genes, *SLCO1B3*, and *ALDOB*. These differentially expressed genes are involved in various pathways, e.g., oxidation, glycolysis, associated with important liver functions.",
                    "Footer": "Hints:\n* Select the regions on the graph with the genes that are differentially expressed to see all the ROIs where those genes are more highly expressed.\n* Turning on only a single channel may help you see smaller ROIs.",
                    "Arrows": [],
                    "Overlays": [],
                    "Group": "All Markers",
                    "Masks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3"
                    ],
                    "ActiveMasks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3"
                    ],
                    "Zoom": 1,
                    "Pan": [
                        0.5,
                        0.5
                    ],
                    "VisBarChart": {
                        "config": {
                            "view": {
                                "continuousWidth": 400,
                                "continuousHeight": 400
                            },
                            "background": null
                        },
                        "width": "container",
                        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                        "data": {
                            "url": "data/volcanoplot_Zone13.csv"
                        },
                        "layer": [
                            {
                                "mark": {
                                    "type": "point",
                                    "filled": true
                                },
                                "encoding": {
                                    "x": {
                                        "field": "FC",
                                        "type": "quantitative",
                                        "title": "Zone 1 ← log2(FC) → Zone 3",
                                        "axis": {
                                            "titleFontSize": 9
                                        }
                                    },
                                    "y": {
                                        "field": "Significance",
                                        "type": "quantitative",
                                        "title": "Significance, -log10(P)"
                                    },
                                    "color": {
                                        "field": "Color",
                                        "type": "nominal",
                                        "scale": null
                                    }
                                }
                            },
                            {
                                "mark": {
                                    "type": "rect",
                                    "fillOpacity": 0,
                                    "stroke": "red"
                                },
                                "data": {
                                    "values": [
                                        {
                                            "type": "Zone 1"
                                        }
                                    ]
                                },
                                "encoding": {
                                    "y": {
                                        "datum": 1.3
                                    },
                                    "y2": {
                                        "datum": 5
                                    },
                                    "x": {
                                        "datum": -2.5
                                    },
                                    "x2": {
                                        "datum": -0.585
                                    }
                                }
                            },
                            {
                                "mark": {
                                    "type": "rect",
                                    "fillOpacity": 0,
                                    "stroke": "red"
                                },
                                "data": {
                                    "values": [
                                        {
                                            "type": "Zone 3"
                                        }
                                    ]
                                },
                                "encoding": {
                                    "y": {
                                        "datum": 1.3
                                    },
                                    "y2": {
                                        "datum": 5
                                    },
                                    "x": {
                                        "datum": 0.585
                                    },
                                    "x2": {
                                        "datum": 2.5
                                    }
                                }
                            },
                            {
                                "mark": {
                                    "type": "text",
                                    "align": "right",
                                    "fontSize": 10,
                                    "color": "white",
                                    "stroke": "black",
                                    "strokeWidth": 0.1,
                                    "baseline": "bottom",
                                    "angle": 0
                                },
                                "encoding": {
                                    "x": {
                                        "field": "FC",
                                        "type": "quantitative"
                                    },
                                    "y": {
                                        "field": "Significance",
                                        "type": "quantitative"
                                    },
                                    "text": {
                                        "field": "GeneName"
                                    }
                                }
                            },
                            {
                                "mark": {
                                    "type": "text",
                                    "align": "left",
                                    "fontSize": 10,
                                    "color": "white",
                                    "stroke": "black",
                                    "strokeWidth": 0.2,
                                    "baseline": "bottom",
                                    "angle": 0
                                },
                                "encoding": {
                                    "x": {
                                        "field": "FC",
                                        "type": "quantitative"
                                    },
                                    "y": {
                                        "field": "Significance",
                                        "type": "quantitative"
                                    },
                                    "text": {
                                        "field": "GeneName2"
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "Name": "Validating Gene Expression with Protein Expression 1",
                    "Description": "We explored the relationship between our data and the [**Human Protein Atlas**](https://www.proteinatlas.org/) to investigate whether the gene expression patterns we observed would correspond to existing protein data. Here we see expression of the *CYP1A2* gene alongside the IHC for the corresponding protein. The protein is expressed in Zone 3, which correlates well to the observed gene expression in Zone 3 ROIs. The other two examples are *CYP2E1* and *CYP3A4*.\n\nCytochromes P450 (CYPs) are a family of monooxygenases involved in the metabolism of various endogenous substrates, including fatty acids, steroid hormones, and vitamins.\n\n![image](img/CYP1A2.png)\n\n[*Image credit: Human Protein Atlas.*](https://www.proteinatlas.org/ENSG00000140505-CYP1A2/tissue/liver#img)",
                    "Footer": "Hints:\n* Select a single data point to be taken to the corresponding ROI.\n* If you hover your mouse over the boxplot, a summary of the distribution metrics for that ROI type will be displayed.",
                    "Arrows": [],
                    "Overlays": [],
                    "Group": "All Markers",
                    "Masks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3"
                    ],
                    "ActiveMasks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3"
                    ],
                    "Zoom": 1,
                    "Pan": [
                        0.5,
                        0.5
                    ],
                    "chanAndMaskandPan": {
                        "config": {
                            "view": {
                                "continuousWidth": 400,
                                "continuousHeight": 300
                            },
                            "background": null,
                            "numberFormat": ".0f"
                        },
                        "width": "container",
                        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                        "data": {
                            "url": "data/CYP.csv",
                            "format": {
                                "parse": {
                                    "X_position": "number",
                                    "Y_position": "number",
                                    "type": "string",
                                    "CYP1A2": "number",
                                    "x_axis": "number"
                                }
                            }
                        },
                        "layer": [
                            {
                                "mark": {
                                    "type": "boxplot",
                                    "ticks": {
                                        "color": "white"
                                    },
                                    "color": "white",
                                    "size": 30
                                },
                                "encoding": {
                                    "color": {
                                        "field": "type",
                                        "legend": null,
                                        "scale": {
                                            "domain": [
                                                "Zone 1",
                                                "Zone 2",
                                                "Zone 3"
                                            ],
                                            "range": [
                                                "#fec4e4",
                                                "#f093c7",
                                                "#be719c"
                                            ]
                                        }
                                    },
                                    "x": {
                                        "type": "nominal",
                                        "field": "type",
                                        "title": null,
                                        "sort": [
                                            "Zone 1",
                                            "Zone 2",
                                            "Zone 3"
                                        ]
                                    },
                                    "y": {
                                        "type": "quantitative",
                                        "field": "CYP1A2",
                                        "title": "CYP1A2 Normalized Expression"
                                    }
                                }
                            },
                            {
                                "mark": {
                                    "type": "point",
                                    "color": "white",
                                    "fill": "white",
                                    "stroke": "red",
                                    "strokeWidth": 1,
                                    "size": 60
                                },
                                "encoding": {
                                    "x": {
                                        "field": "x_axis",
                                        "title": null,
                                        "type": "quantitative",
                                        "scale": {
                                            "domain": [
                                                0,
                                                3
                                            ]
                                        },
                                        "axis": {
                                            "labels": false,
                                            "ticks": false
                                        }
                                    },
                                    "y": {
                                        "field": "CYP1A2",
                                        "type": "quantitative"
                                    },
                                    "tooltip": [
                                        {
                                            "field": "CYP1A2",
                                            "type": "quantitative",
                                            "title": "CYP1A2 Normalized Expression",
                                            "format": ".0f"
                                        },
                                        {
                                            "field": "type",
                                            "type": "nominal",
                                            "title": "ROI Category"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "Name": "Validating Gene Expression with Protein Expression 2",
                    "Description": "We explored the relationship between our data and the [**Human Protein Atlas**](https://www.proteinatlas.org/) to investigate whether the gene expression patterns we observed would correspond to existing protein data. Here we see expression of the *ALDOB* gene alongside the IHC for the corresponding protein. The protein is expressed at an elevated level in Zone 1 compared to Zone 3.\n\n*ALDOB* is an enzyme involved in step 4 of the sub-pathway that synthesizes D-glyceraldehyde 3-phosphate and glycerone phosphate from D-glucose. This sub-pathway is part of glycolysis, which is itself part of carbohydrate degradation.\n\n![image](img/ALDOB.png)\n\n[*Image credit: Human Protein Atlas.*](https://www.proteinatlas.org/ENSG00000136872-ALDOB/tissue/liver#img)",
                    "Footer": "Hints:\n* Select a single data point to be taken to the corresponding ROI.\n* If you hover your mouse over the boxplot, a summary of the distribution metrics for that ROI type will be displayed.",
                    "Arrows": [],
                    "Overlays": [],
                    "Group": "All Markers",
                    "Masks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3"
                    ],
                    "ActiveMasks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3"
                    ],
                    "Zoom": 1,
                    "Pan": [
                        0.5,
                        0.5
                    ],
                    "chanAndMaskandPan": {
                        "config": {
                            "view": {
                                "continuousWidth": 400,
                                "continuousHeight": 300
                            },
                            "background": null,
                            "numberFormat": ".0f"
                        },
                        "width": "container",
                        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                        "data": {
                            "url": "data/ALDOB.csv",
                            "format": {
                                "parse": {
                                    "X_position": "number",
                                    "Y_position": "number",
                                    "type": "string",
                                    "ALDOB": "number",
                                    "x_axis": "number"
                                }
                            }
                        },
                        "layer": [
                            {
                                "mark": {
                                    "type": "boxplot",
                                    "extent": "min-max",
                                    "ticks": {
                                        "color": "white"
                                    },
                                    "color": "white",
                                    "size": 30
                                },
                                "encoding": {
                                    "color": {
                                        "field": "type",
                                        "legend": null,
                                        "scale": {
                                            "domain": [
                                                "Zone 1",
                                                "Zone 2",
                                                "Zone 3"
                                            ],
                                            "range": [
                                                "#fec4e4",
                                                "#f093c7",
                                                "#be719c"
                                            ]
                                        }
                                    },
                                    "x": {
                                        "type": "nominal",
                                        "field": "type",
                                        "title": null,
                                        "sort": [
                                            "Zone 1",
                                            "Zone 2",
                                            "Zone 3"
                                        ]
                                    },
                                    "y": {
                                        "type": "quantitative",
                                        "field": "ALDOB",
                                        "title": "ALDOB Normalized Expression"
                                    }
                                }
                            },
                            {
                                "mark": {
                                    "type": "point",
                                    "color": "white",
                                    "fill": "white",
                                    "stroke": "red",
                                    "strokeWidth": 1,
                                    "size": 60
                                },
                                "encoding": {
                                    "x": {
                                        "field": "x_axis",
                                        "title": null,
                                        "type": "quantitative",
                                        "scale": {
                                            "domain": [
                                                0,
                                                3
                                            ]
                                        },
                                        "axis": {
                                            "labels": false,
                                            "ticks": false
                                        }
                                    },
                                    "y": {
                                        "field": "ALDOB",
                                        "type": "quantitative"
                                    },
                                    "tooltip": [
                                        {
                                            "field": "ALDOB",
                                            "type": "quantitative",
                                            "title": "ALDOB Normalized Expression",
                                            "format": ".0f"
                                        },
                                        {
                                            "field": "type",
                                            "type": "nominal",
                                            "title": "ROI Category"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "Name": "Spatial Mapping of Genes",
                    "Description": "Whole transcriptome profiling allows us to spatially map functional gene expression. This heatmap shows relative expression of various genes in different ROIs in the lobular zones between central veins and portal triads. These genes exhibited a gradient of expression levels. Each lobular region below is composed of its respective Zones I, II, and III AOIs.",
                    "Footer": "Hints:\n* Hold mouse over the main body of heatmap to show the gene that a row corresponds to.\n* Hold mouse over the bottom key bar to identify a specific lobular region.\n* Click on a column to zoom in on the corresponding ROI on the image.",
                    "Arrows": [],
                    "Overlays": [],
                    "Group": "All Markers",
                    "Masks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3"
                    ],
                    "ActiveMasks": [
                        "Zone 1",
                        "Zone 2",
                        "Zone 3"
                    ],
                    "Zoom": 1,
                    "Pan": [
                        0.5,
                        0.5
                    ],
                    "MaskAndPan": {
                        "config": {
                            "axis": {
                                "domain": false
                            },
                            "view": {
                                "continuousWidth": 400,
                                "continuousHeight": 300
                            },
                            "background": null
                        },
                        "width": "container",
                        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                        "layer": [
                            {
                                "data": {
                                    "url": "data/ZoneHeatmap.csv"
                                },
                                "mark": "rect",
                                "encoding": {
                                    "x": {
                                        "field": "ROILabel",
                                        "type": "nominal",
                                        "title": null,
                                        "sort": null,
                                        "axis": {
                                            "labels": false,
                                            "ticks": false
                                        }
                                    },
                                    "y": {
                                        "field": "Gene",
                                        "type": "nominal",
                                        "sort": {
                                            "field": "Group"
                                        },
                                        "title": null,
                                        "axis": {
                                            "labelColor": {
                                                "expr": "datum.value == 'CXCL14' ? '#009E73' : datum.value == 'THBS1' ? '#009E73' : datum.value == 'AKR1C1' ? '#009E73' : datum.value == 'SLCO1B3' ? '#009E73' : datum.value == 'CYP1A2' ? '#009E73' : datum.value == 'CYP3A4' ? '#009E73' : datum.value == 'AKR1C2' ? '#009E73' : datum.value == 'GLUL' ? '#009E73' : datum.value == 'GADD45G' ? '#009E73' : datum.value == 'CYP2E1' ? '#009E73' : datum.value == 'AOX1' ? '#009E73' : datum.value == 'ADH1B' ? '#009E73' : datum.value == 'ADH1A' ? '#009E73' : '#F0E442'"
                                            }
                                        }
                                    },
                                    "color": {
                                        "field": "Expression",
                                        "type": "quantitative",
                                        "scale": {
                                            "domain": [
                                                -1.5,
                                                1.5
                                            ],
                                            "scheme": "viridis"
                                        },
                                        "legend": {
                                            "orient": "top"
                                        },
                                        "title": null
                                    },
                                    "facet": {
                                        "field": "Lobular",
                                        "type": "ordinal",
                                        "column": 6
                                    },
                                    "tooltip": [
                                        {
                                            "field": "Gene",
                                            "type": "nominal"
                                        },
                                        {
                                            "field": "type",
                                            "type": "nominal",
                                            "title": "Lobular Zone"
                                        }
                                    ]
                                }
                            },
                            {
                                "data": {
                                    "url": "data/ZoneHeatmapAnnotation.csv"
                                },
                                "mark": {
                                    "type": "bar",
                                    "yOffset": 540
                                },
                                "height": 20,
                                "encoding": {
                                    "x": {
                                        "field": "Percentage",
                                        "type": "quantitative",
                                        "axis": {
                                            "labels": false,
                                            "ticks": false
                                        },
                                        "title": null
                                    },
                                    "y": {
                                        "field": "bar",
                                        "type": "nominal",
                                        "title": null,
                                        "axis": {
                                            "labels": false,
                                            "ticks": false
                                        }
                                    },
                                    "tooltip": {
                                        "field": "Lobular",
                                        "type": "nominal",
                                        "title": "Lobular Region"
                                    },
                                    "color": {
                                        "field": "Lobular",
                                        "type": "nominal",
                                        "sort": null,
                                        "legend": {
                                            "title": "Lobular Region",
                                            "offset": 580,
                                            "orient": "bottom",
                                            "direction": "vertical"
                                        },
                                        "scale": {
                                            "domain": [
                                                "Region 1",
                                                "Region 2",
                                                "Region 3",
                                                "Region 4",
                                                "Region 5",
                                                "Region 6"
                                            ],
                                            "range": [
                                                "#FFFF00",
                                                "#FF00FF",
                                                "#00FFFF",
                                                "#0000FF",
                                                "#00FF00",
                                                "#FF0000"
                                            ]
                                        }
                                    },
                                    "order": {
                                        "field": "Lobular"
                                    }
                                }
                            },
                            {
                                "data": {
                                    "url": "data/ZoneHeatmapAnnotation.csv"
                                },
                                "mark": {
                                    "type": "bar",
                                    "yOffset": 560
                                },
                                "height": 20,
                                "encoding": {
                                    "x": {
                                        "field": "Percentage",
                                        "type": "quantitative",
                                        "axis": {
                                            "labels": false,
                                            "ticks": false
                                        },
                                        "title": null
                                    },
                                    "y": {
                                        "field": "bar",
                                        "type": "nominal",
                                        "title": null,
                                        "axis": {
                                            "labels": false,
                                            "ticks": false
                                        }
                                    },
                                    "tooltip": {
                                        "field": "Lobular",
                                        "type": "nominal",
                                        "title": "Lobular Region"
                                    },
                                    "color": {
                                        "field": "type",
                                        "type": "nominal",
                                        "sort": null,
                                        "legend": {
                                            "title": "ROI Type",
                                            "offset": 580,
                                            "orient": "bottom",
                                            "direction": "vertical"
                                        },
                                        "scale": {
                                            "domain": [
                                                "Zone 1",
                                                "Zone 2",
                                                "Zone 3"
                                            ],
                                            "range": [
                                                "#fec4e4",
                                                "#f093c7",
                                                "#be719c"
                                            ]
                                        }
                                    },
                                    "order": {
                                        "field": "Lobular"
                                    }
                                }
                            }
                        ],
                        "resolve": {
                            "scale": {
                                "y": "independent"
                            }
                        }
                    }
                }
            ]
        }
    ],
    "Masks": [
        {
            "Path": "All-Cells",
            "Name": "All Cells",
            "Colors": [
                "ffffff"
            ],
            "Channels": [
                "All Cells"
            ]
        },
        {
            "Path": "Zone-1",
            "Name": "Zone 1",
            "Colors": [
                "fec4e4"
            ],
            "Channels": [
                "Zone 1"
            ]
        },
        {
            "Path": "Zone-2",
            "Name": "Zone 2",
            "Colors": [
                "f093c7"
            ],
            "Channels": [
                "Zone 2"
            ]
        },
        {
            "Path": "Zone-3",
            "Name": "Zone 3",
            "Colors": [
                "be719c"
            ],
            "Channels": [
                "Zone 3"
            ]
        },
        {
            "Path": "Central-Vein",
            "Name": "Central Vein",
            "Colors": [
                "37a7e5"
            ],
            "Channels": [
                "Central Vein"
            ]
        },
        {
            "Path": "Bile-Duct",
            "Name": "Bile Duct",
            "Colors": [
                "d55e00"
            ],
            "Channels": [
                "Bile Duct"
            ]
        },
        {
            "Path": "Artery",
            "Name": "Artery",
            "Colors": [
                "f0e442"
            ],
            "Channels": [
                "Artery"
            ]
        },
        {
            "Path": "Portal-Vein",
            "Name": "Portal Vein",
            "Colors": [
                "009e73"
            ],
            "Channels": [
                "Portal Vein"
            ]
        },
        {
            "Path": "CV-Macrophage",
            "Name": "CV Macrophage",
            "Colors": [
                "ccf2f7"
            ],
            "Channels": [
                "CV Macrophage"
            ]
        },
        {
            "Path": "CV-Sinusoid",
            "Name": "CV Sinusoid",
            "Colors": [
                "fdae70"
            ],
            "Channels": [
                "CV Sinusoid"
            ]
        },
        {
            "Path": "Liver-Macrophage",
            "Name": "Liver Macrophage",
            "Colors": [
                "b9f9e8"
            ],
            "Channels": [
                "Liver Macrophage"
            ]
        },
        {
            "Path": "Liver-Sinusoid",
            "Name": "Liver Sinusoid",
            "Colors": [
                "beb532"
            ],
            "Channels": [
                "Liver Sinusoid"
            ]
        },
        {
            "Path": "PV-Macrophage",
            "Name": "PV Macrophage",
            "Colors": [
                "fff9ad"
            ],
            "Channels": [
                "PV Macrophage"
            ]
        },
        {
            "Path": "PV-Sinusoid",
            "Name": "PV Sinusoid",
            "Colors": [
                "cbcbcb"
            ],
            "Channels": [
                "PV Sinusoid"
            ]
        }
    ],
    "Groups": [
        {
            "Name": "All Markers",
            "Path": "All-Markers_0__DNA--1__CK818--2__CD68--3__SMA",
            "Colors": [
                "0000ff",
                "00ff00",
                "ffff00",
                "ff00ff"
            ],
            "Channels": [
                "DNA",
                "CK8/18",
                "CD68",
                "SMA"
            ]
        },
        {
            "Name": "CD68/SMA/DNA",
            "Path": "CD68-SMA_0__DNA--2__CD68--3__SMA",
            "Colors": [
                "0000ff",
                "ffff00",
                "ff00ff"
            ],
            "Channels": [
                "DNA",
                "CD68",
                "SMA"
            ]
        },
        {
            "Name": "CK8",
            "Path": "CK8_1__CK818",
            "Colors": [
                "00ff00"
            ],
            "Channels": [
                "CK8/18"
            ]
        },
        {
            "Name": "CD68",
            "Path": "CD68_2__CD68",
            "Colors": [
                "ffff00"
            ],
            "Channels": [
                "CD68"
            ]
        },
        {
            "Name": "SMA",
            "Path": "SMA_3__SMA",
            "Colors": [
                "ff00ff"
            ],
            "Channels": [
                "SMA"
            ]
        },
        {
            "Name": "Nuclei",
            "Path": "Nuclei_0__DNA",
            "Colors": [
                "0000ff"
            ],
            "Channels": [
                "DNA"
            ]
        }
    ]
}